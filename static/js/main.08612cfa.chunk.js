(this["webpackJsonptodo-app"]=this["webpackJsonptodo-app"]||[]).push([[0],{28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(17),o=(n(26),n(27),n(28),n(12)),s=n(11),i=n(2),u=n.n(i),l=n(4),d=n(3),p="https://mate.academy/students-api";function f(e){return new Promise((function(t){setTimeout(t,e)}))}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),f(500).then((function(){return fetch(p+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var j,m=function(e){return b(e)},h=function(e,t){return b(e,"POST",t)},O=function(e,t){return b(e,"PATCH",t)},v=function(e){return b(e,"DELETE")},x=function(e){return h("/todos",e)},g=function(e){return v("/todos/".concat(e))},y=function(e,t){return O("/todos/".concat(e),t)},k=n(5),N=n.n(k),T=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",h("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=n(0),C=function(e){var t=e.onLogin,n=Object(r.useState)(""),a=Object(d.a)(n,2),c=a[0],o=a[1],s=Object(r.useState)(""),i=Object(d.a)(s,2),p=i[0],f=i[1],b=Object(r.useState)(!1),j=Object(d.a)(b,2),m=j[0],h=j[1],O=Object(r.useState)(!1),v=Object(d.a)(O,2),x=v[0],g=v[1],y=Object(r.useState)(""),k=Object(d.a)(y,2),C=k[0],_=k[1],S=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){_("Need to login")}}),[]);var I=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(c);case 2:(t=e.sent)?S(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),_(""),g(!0),e.prev=3,!m){e.next=9;break}return e.next=7,E({name:p,email:c}).then(S);case 7:e.next=11;break;case 9:return e.next=11,I();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),_("Something went wrtong");case 16:return e.prev=16,g(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(w.jsx)("h1",{className:"title is-3",children:m?"You need to register":"Log in to open todos"}),Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(w.jsxs)("div",{className:N()("control has-icons-left",{"is-loading":x}),children:[Object(w.jsx)("input",{type:"email",id:"user-email",className:N()("input",{"is-danger":!m&&C}),placeholder:"Enter your email",disabled:x||m,value:c,required:!0,onChange:function(e){return o(e.target.value)}}),Object(w.jsx)("span",{className:"icon is-small is-left",children:Object(w.jsx)("i",{className:"fas fa-envelope"})})]}),!m&&C&&Object(w.jsx)("p",{className:"help is-danger",children:C})]}),m&&Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(w.jsxs)("div",{className:N()("control has-icons-left",{"is-loading":x}),children:[Object(w.jsx)("input",{type:"text",id:"user-name",className:N()("input",{"is-danger":m&&C}),placeholder:"Enter your name",required:!0,minLength:4,disabled:x,value:p,onChange:function(e){return f(e.target.value)}}),Object(w.jsx)("span",{className:"icon is-small is-left",children:Object(w.jsx)("i",{className:"fas fa-user"})})]}),m&&C&&Object(w.jsx)("p",{className:"help is-danger",children:C})]}),Object(w.jsx)("div",{className:"field",children:Object(w.jsx)("button",{type:"submit",className:N()("button is-primary",{"is-loading":x}),children:m?"Register":"Login"})})]})},_=a.a.createContext(null),S=function(e){var t=e.children,n=Object(r.useState)(null),a=Object(d.a)(n,2),c=a[0],o=a[1];return c?Object(w.jsx)(_.Provider,{value:c,children:t}):Object(w.jsx)(C,{onLogin:o})};!function(e){e.None="",e.LoadError="Unable to load a todos",e.UploadError="Unable to add a todo",e.UpdatedError="Unable to uodate a todo",e.RemoveError="Unable to delete a todo",e.EmptyTitle="Title can't be empty"}(j||(j={}));var I,L=function(e){var t=e.isUploadError,n=e.onAdd,a=e.isTodoLoading,c=e.toggleAll,o=e.setError,s=Object(r.useState)(""),i=Object(d.a)(s,2),u=i[0],l=i[1],p=Object(r.useRef)(null),f=Object(r.useContext)(_);return Object(r.useEffect)((function(){p.current&&p.current.focus()}),[]),Object(w.jsxs)("header",{className:"todoapp__header",children:[Object(w.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:"todoapp__toggle-all active",onClick:c}),Object(w.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),u.trim()){var t={title:u.trim(),completed:!1,userId:null===f||void 0===f?void 0:f.id,id:0};n(t),l("")}else o(j.EmptyTitle)},children:Object(w.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:p,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:u,onChange:function(e){return l(e.target.value)},disabled:t||a})})]})};!function(e){e.Active="active",e.Completed="completed",e.All="all"}(I||(I={}));var D=function(e){var t=e.todos,n=e.setFiltredTodos,a=e.clearCompleted,c=e.completedTodos,o=Object(r.useState)(I.All),s=Object(d.a)(o,2),i=s[0],u=s[1],l=function(e){u(e)},p=Object(r.useMemo)((function(){return t.filter((function(e){switch(i){case I.Active:return!e.completed;case I.Completed:return e.completed;default:return e}}))}),[i,t]);return Object(r.useEffect)((function(){n(p)}),[p]),Object(w.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(w.jsxs)("span",{className:"todo-count","data-cy":"todosCounter",children:[t.filter((function(e){return!e.completed})).length," ","items left"]}),Object(w.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(w.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:N()("filter__link",{selected:i===I.All}),onClick:function(){return l(I.All)},children:"All"}),Object(w.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:N()("filter__link",{selected:i===I.Active}),onClick:function(){return l(I.Active)},children:"Active"}),Object(w.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:N()("filter__link",{selected:i===I.Completed}),onClick:function(){return l(I.Completed)},children:"Completed"})]}),Object(w.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:N()("todoapp__clear-completed",{"is-hidden":!c}),onClick:a,children:"Clear completed"})]})},A=n(36),U=n(35),F=a.a.memo((function(e){var t=e.todoList,n=e.onDelete,a=e.deletedTodosId,c=e.activeTodoId,o=e.hendeleCheckboxChange,s=e.editTodo,i=e.updatedTodoID,p=t.title,f=t.completed,b=t.id,j=a.includes(b)||c.includes(b)||i.includes(b),m=Object(r.useState)(!1),h=Object(d.a)(m,2),O=h[0],v=h[1],x=Object(r.useState)(p),g=Object(d.a)(x,2),y=g[0],k=g[1],T=Object(r.useRef)(null);Object(r.useEffect)((function(){T.current&&T.current.focus()}),[O]);var E=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),y.trim()===p){e.next=4;break}return e.next=4,s(b,y);case 4:y.length||n(b),v(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{"data-cy":"Todo",className:N()("todo",{completed:f}),children:[Object(w.jsx)("label",{className:"todo__status-label",children:Object(w.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:!0,onChange:function(){return o(b,f)}})}),O?Object(w.jsx)("form",{onSubmit:E,children:Object(w.jsx)("input",{type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",ref:T,value:y,onChange:function(e){return k(e.target.value)},onBlur:function(e){e.preventDefault(),y.trim()&&s(b,y),v(!1)},onKeyDown:function(e){"Escape"===e.key&&(k(p),v(!1))}})}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return v(!0)},children:p}),Object(w.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return n(b)},children:"\xd7"})]}),Object(w.jsxs)("div",{"data-cy":"TodoLoader",className:N()("modal","overlay",{"is-active":j}),children:[Object(w.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(w.jsx)("div",{className:"loader"})]})]})})),R=a.a.memo((function(e){var t=e.filtredTodos,n=e.isTodoLoading,r=e.onDelete,a=e.deletedTodosId,c=e.tempTodo,o=e.activeTodoId,s=e.hendeleCheckboxChange,i=e.editTodo,u=e.updatedTodoID;return Object(w.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(w.jsxs)(A.a,{children:[t.map((function(e){return Object(w.jsx)(U.a,{timeout:300,classNames:"item",children:Object(w.jsx)(F,{todoList:e,onDelete:r,deletedTodosId:a,activeTodoId:o,hendeleCheckboxChange:s,editTodo:i,updatedTodoID:u},e.id)},e.id)})),n&&c&&Object(w.jsx)(U.a,{timeout:300,classNames:"temp-item",children:Object(w.jsx)(F,{todoList:c,onDelete:r,deletedTodosId:a,activeTodoId:o,hendeleCheckboxChange:s,editTodo:i,updatedTodoID:u},c.id)},0)]})})})),B=Object(r.memo)((function(e){var t=e.error,n=e.setError,a=Object(r.useState)(""),c=Object(d.a)(a,2),o=c[0],s=c[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){n(j.None)}),3e3);return function(){clearTimeout(e)}}),[t]),Object(r.useMemo)((function(){switch(t){case j.LoadError:s(j.LoadError);break;case j.UploadError:s("Unable to add a todo");break;case j.RemoveError:s(j.RemoveError);break;case j.UpdatedError:s(j.UpdatedError);break;case j.EmptyTitle:s(j.EmptyTitle);break;default:s("")}}),[t]),Object(w.jsxs)("div",{"data-cy":"ErrorNotification",className:"notification is-danger is-light has-text-weight-normal",children:[Object(w.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete","aria-label":"Delete",onClick:function(){return n(j.None)}}),o]})})),J=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(j.None),i=Object(d.a)(c,2),p=i[0],f=i[1],b=Object(r.useState)([]),h=Object(d.a)(b,2),O=h[0],v=h[1],k=Object(r.useState)(null),N=Object(d.a)(k,2),T=N[0],E=N[1],C=Object(r.useState)([]),S=Object(d.a)(C,2),I=S[0],A=S[1],U=Object(r.useState)(!1),F=Object(d.a)(U,2),J=F[0],P=F[1],M=Object(r.useState)([]),q=Object(d.a)(M,2),H=q[0],Y=q[1],G=Object(r.useState)([]),K=Object(d.a)(G,2),W=K[0],z=K[1],Q=Object(r.useState)([]),V=Object(d.a)(Q,2),X=V[0],Z=V[1],$=Object(r.useContext)(_),ee=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!$){e.next=6;break}return e.next=4,n=$.id,m("/todos?userId=".concat(n));case 4:t=e.sent,v(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),f(j.LoadError);case 11:case"end":return e.stop()}var n}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$){e.next=20;break}return P(!0),e.prev=2,z([0]),E(t),e.next=7,x({title:t.title,userId:t.userId,completed:!1});case 7:n=e.sent,v((function(e){return[].concat(Object(s.a)(e),[n])})),z([]),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),a(!0),f(j.UploadError);case 16:return e.prev=16,E(null),P(!1),e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[2,12,16,20]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Y((function(e){return[].concat(Object(s.a)(e),[t])})),e.next=4,g(t);case 4:n=I.filter((function(e){return e.id!==t})),v(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),f(j.RemoveError);case 11:Y([]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(s.a)(O).map((function(e){return e.id===t&&(e.title=n),e})),v(r),e.prev=2,Z((function(e){return[].concat(Object(s.a)(e),[t])})),e.next=6,y(t,{title:n});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),f(j.UpdatedError);case 11:Z([]);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}(),ae=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O.filter((function(e){return e.completed})),n=t.map((function(e){return e.id})),Y(n),e.next=5,Promise.all(t.map((function(e){return g(e.id)})));case 5:r=O.filter((function(e){return!e.completed})),v(r),Y([]);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y(t,{completed:!n});case 3:r=O.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{completed:!n}):e})),v(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f(j.UpdatedError);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),oe=Object(r.useMemo)((function(){return O.filter((function(e){return e.completed})).length}),[O]),se=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=O.length,n=O.filter((function(e){return e.completed})).length===t,v(O.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{completed:!n})})));try{(r=O.filter((function(e){return!e.completed}))).length?r.forEach(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(t.id,{completed:!t.completed});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):O.forEach(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(t.id,{completed:!t.completed});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(a){f(j.UpdatedError)}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){ee()}),[]),Object(w.jsxs)("div",{className:"todoapp",children:[Object(w.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(w.jsxs)("div",{className:"todoapp__content",children:[Object(w.jsx)(L,{onAdd:te,toggleAll:se,isUploadError:n,setError:f,isTodoLoading:J}),Object(w.jsx)(R,{filtredTodos:I,isTodoLoading:J,deletedTodosId:H,tempTodo:T,activeTodoId:W,onDelete:ne,hendeleCheckboxChange:ce,editTodo:re,updatedTodoID:X}),Object(w.jsx)(D,{todos:O,setFiltredTodos:A,clearCompleted:ae,completedTodos:oe})]}),p!==j.None&&Object(w.jsx)(B,{error:p,setError:f})]})},P=function(){return Object(w.jsx)(S,{children:Object(w.jsx)(J,{})})};Object(c.createRoot)(document.getElementById("root")).render(Object(w.jsx)(P,{}))}},[[33,1,2]]]);
//# sourceMappingURL=main.08612cfa.chunk.js.map